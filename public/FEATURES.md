# 📋 기능 상세 가이드

이 문서는 지구화학 데이터 분석기의 모든 기능을 상세하게 설명합니다.

> ⚠️ **개발자 주의**: 새 기능을 추가할 때는 반드시 이 파일을 업데이트하세요!

## 📑 목차

1. [데이터 업로드 및 관리](#1-데이터-업로드-및-관리)
2. [변수 선택](#2-변수-선택)
3. [차트 스타일 설정](#3-차트-스타일-설정)
4. [플롯 스타일 설정](#4-플롯-스타일-설정)
5. [축 범위 및 스케일](#5-축-범위-및-스케일)
6. [오차범위 설정](#6-오차범위-설정)
7. [내보내기 기능](#7-내보내기-기능)
8. [통계 분석](#8-통계-분석)

---

## 1. 데이터 업로드 및 관리

### 1.1 파일 업로드
- **위치**: 메인 페이지 상단
- **지원 형식**: `.xlsx`, `.xls`, `.csv`
- **방법**:
  - 드래그 앤 드롭
  - 클릭하여 파일 선택
- **제약사항**:
  - 첫 번째 행은 헤더(컬럼 이름)여야 함
  - 수치 데이터는 자동 감지

### 1.2 타입 분류 설정
- **위치**: 데이터 뷰어 → "타입 분류 설정" (노란색 섹션)
- **기능**:
  - 타입별 분류 사용 체크박스
  - 타입 컬럼 선택 드롭다운
- **사용 예시**: Rock_Type, Sample_Group 등 문자형 컬럼 선택
- **효과**: 각 타입별로 다른 색상으로 플롯 표시

---

## 2. 변수 선택

### 2.1 X축/Y축 변수 설정
- **위치**: 데이터 뷰어 → "분석 변수 선택"
- **타입 선택**:
  - **단일 컬럼**: 하나의 수치형 컬럼 선택
  - **비율**: 분자/분모 컬럼 선택하여 비율 계산
- **예시**:
  - 단일: `SiO2`, `Al2O3`
  - 비율: `SiO2/TiO2`, `La/Yb`

---

## 3. 차트 스타일 설정

### 3.1 숫자 형식 (X축/Y축 독립 설정)
- **위치**: 차트 스타일 패널 (파란색 하이라이트)
- **X축 숫자 형식**:
  - 일반: `123.456`
  - 과학적 표기법: `1.23e+2` 또는 `1.23×10²` (위첨자)
  - 천 단위 구분: `1,234.567`
- **Y축 숫자 형식**: X축과 독립적으로 설정 가능

### 3.2 폰트 및 텍스트 설정
- **폰트**: Arial, Times New Roman, Helvetica, Georgia
- **축 제목 크기**: 8-24px
- **축 숫자 크기**: 6-20px
- **축 제목 굵게**: 체크박스

### 3.3 축 제목 위치 조정
- **X축 제목 위치**: -100 ~ 0 (음수: 아래로, 양수: 위로)
- **Y축 제목 위치**: -60 ~ 20 (음수: 왼쪽으로, 양수: 오른쪽으로)
- **사용 시나리오**: 과학적 표기법 사용 시 제목과 숫자가 겹칠 때

---

## 4. 플롯 스타일 설정

### 4.1 마커 설정
- **위치**: 플롯 스타일 패널 (보라색 하이라이트)
- **마커 크기**: 20-200
- **마커 모양**: 원, 사각형, 삼각형, 다이아몬드
- **불투명도**: 0.1-1.0
- **테두리 두께**: 0-5px
- **테두리 색상**: 색상 피커

### 4.2 배경 및 격자
- **배경색**: 색상 피커로 선택
- **격자 표시**: 체크박스

### 4.3 데이터 포인트 라벨
- **위치**: 플롯 스타일 → 데이터 포인트 라벨
- **기능**: 각 포인트에 타입 이름 표시
- **라벨 폰트 크기**: 6-16px
- **주의**: 데이터가 많으면 라벨이 겹칠 수 있음

### 4.4 차트 제목
- **제목 표시**: 체크박스
- **제목 입력**: 텍스트 필드
- **위치**: 차트 상단 중앙

### 4.5 타입별 색상 설정
- **사용자 정의 색상 사용**: 체크박스
- **색상 팔레트**: 최대 8개 색상 커스터마이징
- **기본값 재설정**: 버튼 클릭으로 원래 색상으로 복구

### 4.6 추세선 스타일
- **전체 추세선**: 모든 데이터의 회귀선
- **타입별 추세선**: 각 타입별 독립적인 회귀선
- **색상**: 색상 피커
- **선 두께**: 슬라이더
- **불투명도**: 슬라이더

---

## 5. 축 범위 및 스케일

### 5.1 축 범위 설정
- **위치**: 축 범위 패널 (초록색 하이라이트)
- **수동 범위 설정**:
  - X축 최솟값/최댓값
  - Y축 최솟값/최댓값
  - 비워두면 자동 설정

### 5.2 축 스케일 설정
- **X축 로그 스케일**: 체크박스
- **Y축 로그 스케일**: 체크박스
- **1:1 비율 유지**: 정사각형 플롯 생성
- **1:1 참조선 표시**: y=x 대각선 표시
- **주의**: 로그 스케일은 양수 값에만 적용

### 5.3 축 반전
- **X축 반전**: 오른쪽→왼쪽으로 값 표시
- **Y축 반전**: 위→아래로 값 표시 (지질학 깊이 프로파일용)

### 5.4 눈금 간격 설정
- **X축 눈금 간격**: 숫자 입력 (비워두면 자동)
- **Y축 눈금 간격**: 숫자 입력 (비워두면 자동)
- **권장**: 데이터 범위의 10-20% 정도

---

## 6. 오차범위 설정

### 6.1 오차범위 개요
- **위치**: 오차범위 패널 (주황색 하이라이트)
- **기능**: 데이터 포인트의 불확실성을 시각적으로 표현
- **독립 설정**: X축과 Y축 각각 독립적으로 설정 가능
- **타입별 색상**: 각 타입의 색상과 동일한 오차막대 표시

### 6.2 X축 오차범위
- **위치**: 오차범위 패널 → "X축 오차범위 표시"
- **계산 방법**:
  1. **백분율 (%)**: 데이터 값의 n%를 오차로 표시
     - 예: 5% 설정 시, 값이 100이면 ±5
     - 슬라이더: 0-100%
  2. **고정값**: 모든 데이터에 동일한 오차값 적용
     - 예: 2.5 설정 시, 모든 점에 ±2.5
     - 슬라이더: 0-50
  3. **데이터 컬럼에서 읽기**: 엑셀/CSV 파일의 특정 컬럼 선택
     - 각 행의 오차값을 해당 컬럼에서 직접 읽기
     - 예: "SiO2_error" 컬럼 선택
  4. **표준편차 (Standard Deviation)**: 자동 계산
     - 전체 X값의 분산 정도를 나타냄
     - 수식: σ = √(Σ(xi - μ)² / n)
  5. **표준오차 (Standard Error)**: 자동 계산
     - 평균의 불확실성 표현
     - 수식: SE = σ / √n
- **색상**: 타입별 색상과 동일

### 6.3 Y축 오차범위
- **위치**: 오차범위 패널 → "Y축 오차범위 표시"
- **계산 방법**: X축과 동일한 5가지 옵션
- **독립 설정**: X축과 다른 방법 선택 가능
- **색상**: 타입별 색상과 동일

### 6.4 사용 시나리오
- **실험 데이터**: 측정 오차가 ±5%인 경우 → 백분율 5% 선택
- **반복 측정 데이터**: 표준편차 또는 표준오차로 재현성 표시
- **문헌 데이터**: 원 논문의 오차값을 별도 컬럼에 저장 후 "컬럼에서 읽기"
- **시뮬레이션 데이터**: 모든 점의 불확실성이 동일하면 고정값 사용
- **통계 분석**: 표준오차로 평균의 신뢰도 표현

### 6.5 주의사항
- 오차범위가 너무 크면 차트가 복잡해질 수 있음
- "컬럼에서 읽기" 선택 시 해당 컬럼이 수치형이어야 함
- 표준편차/표준오차는 전체 데이터를 기준으로 계산됨
- 타입별 독립적인 오차범위는 현재 지원하지 않음

---

## 7. 내보내기 기능

### 7.1 PNG 저장
- **버튼**: 파란색 "PNG 저장"
- **형식**: PNG (래스터 이미지)
- **해상도**: 2x scale (고해상도)
- **포함 내용**: 보이는 모든 요소 (차트, 제목, 라벨 등)

### 7.2 SVG 저장
- **버튼**: 초록색 "SVG 저장"
- **형식**: SVG (벡터 그래픽)
- **장점**:
  - 확대해도 깨지지 않음
  - Illustrator, Inkscape 등에서 편집 가능
  - 파일 크기 작음
- **포함 내용**: 배경색, 모든 그래픽 요소

---

## 8. 통계 분석

### 8.1 상관계수
- **피어슨 상관계수**: 선형 관계 측정 (-1 ~ 1)
- **스피어만 상관계수**: 순위 기반 관계 측정

### 8.2 선형 회귀
- **회귀선**: 최소제곱법
- **R² (결정계수)**: 모델 설명력 (0 ~ 1)
- **p-값**: 통계적 유의성

### 8.3 타입별 통계
- **조건**: 타입 분류 사용 시
- **제공**: 각 타입별 독립적인 통계

---

## 🔄 반응형 레이아웃

### 큰 화면 (XL 이상, ≥1280px)
- **옵션 패널**: 왼쪽 고정 너비 (384px)
- **차트**: 오른쪽 나머지 공간 차지
- **장점**: 설정 변경하면서 차트 실시간 확인

### 작은 화면 (< 1280px)
- **옵션 패널**: 상단
- **차트**: 하단
- **장점**: 모바일/태블릿에서도 편리한 사용

---

## ✅ 패널 상태 표시

- **차트 스타일**: 파란색 배경 (열림 시)
- **플롯 스타일**: 보라색 배경 (열림 시)
- **축 범위**: 초록색 배경 (열림 시)
- **오차범위**: 주황색 배경 (열림 시)
- **닫힘**: 흰색 배경

---

## 🆕 최근 추가된 기능

### v0.5.7 (2024-11-24)
1. ✅ 오차범위 표시 (Error Bars)
   - X/Y축 독립 설정
   - 5가지 계산 방법 (백분율, 고정값, 컬럼, 표준편차, 표준오차)

### v0.5.6 (2024-11-24)
1. ✅ X/Y축 로그 스케일
2. ✅ X/Y축 독립적인 숫자 형식
3. ✅ 위첨자 지수 표기 (10⁴)
4. ✅ 1:1 비율 유지
5. ✅ 1:1 참조선
6. ✅ 눈금 간격 조정
7. ✅ 차트 제목
8. ✅ 축 제목 위치 조정
9. ✅ 패널 하이라이트
10. ✅ 반응형 레이아웃
11. ✅ 축 반전
12. ✅ SVG 내보내기
13. ✅ 데이터 라벨

---

## 📝 개발자를 위한 노트

### 새 기능 추가 시 체크리스트

1. **코드 구현**: `src/components/ScatterPlot.tsx` 수정
2. **이 파일 업데이트**: 해당 섹션에 기능 설명 추가
3. **README.md 업데이트**: 주요 기능 목록에 추가
4. **CHANGELOG.md 업데이트**: 버전과 함께 변경사항 기록
5. **Git 커밋**: 명확한 커밋 메시지 작성
6. **테스트**: 로컬 환경에서 기능 확인

### 문서 작성 가이드

- **명확성**: 사용자가 쉽게 이해할 수 있도록
- **위치 정보**: 기능이 어디 있는지 명시
- **예시**: 가능한 한 예시 제공
- **주의사항**: 제약사항이나 알아야 할 점 표시
- **스크린샷**: 필요시 이미지 추가

### 기능 삭제/변경 시

- 해당 섹션을 ~~취소선~~으로 표시하고 "v0.x.x에서 제거됨" 표시
- 또는 완전히 제거하고 CHANGELOG에 기록

---

**마지막 업데이트**: 2024-11-24
**버전**: 0.5.7
